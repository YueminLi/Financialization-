IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'random')
phtest(m1, m1_re)
fit <- fitted(m1)
fit
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VA._pc ~  DV_VA._pc_lag1 +
IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA._pc ~  DV_VA._pc_lag1 +
IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'random')
phtest(m1, m1_re)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_RVA_pc ~  DV_RVA_pc_lag1 +
IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA._pc ~  DV_VA._pc_lag1 +
IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'random')
phtest(m1, m1_re)
library(tseries)
po.test(as.matrix(cbind(df$DV_nfc_ls_pc, df$IV_lending_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_nfc_ls_pc, df$IV_gov_exp_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_nfc_ls_pc, df$IV_trade_balance_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_nfc_ls_pc, df$IV_fdi_net_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_nfc_ls_pc, df$IV_wgini_pc), demean=FALSE))
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'random')
phtest(m1, m1_re)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m2  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m2)
# PCSE
summary(m2, vcovBK)
# Durbin-Watson Statistics
pdwtest(m2)
# m1_re is a RE model
m2_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'random')
phtest(m2, m2_re)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m2  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m2)
# PCSE
summary(m2, vcovBK)
# Durbin-Watson Statistics
pdwtest(m2)
# m1_re is a RE model
m2_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'random')
phtest(m2, m2_re)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m3  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m3)
# PCSE
summary(m3, vcovBK)
# Durbin-Watson Statistics
pdwtest(m3)
# m1_re is a RE model
m3_re  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'random')
phtest(m3, m3_re)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m3  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi #+ C_wgini,
data = df, model = 'within',
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m3  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi, #+ C_wgini,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m3)
# PCSE
summary(m3, vcovBK)
# Durbin-Watson Statistics
pdwtest(m3)
# m1_re is a RE model
m3_re  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi, #+ C_wgini,
data = df, model = 'random')
phtest(m3, m3_re)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m2  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi, #+ C_wgini,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m2)
# PCSE
summary(m2, vcovBK)
# Durbin-Watson Statistics
pdwtest(m2)
# m1_re is a RE model
m2_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi, #+ C_wgini,
data = df, model = 'random')
phtest(m2, m2_re)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi, #+ C_wgini,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi, #+ C_wgini,
data = df, model = 'random')
phtest(m1, m1_re)
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("../data_processing/financialization_df.csv")
df$X <- NULL
df <- df %>%
filter(Year >= 1960)
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("../data_processing/financialization_df.csv")
df$X <- NULL
df <- df %>%
filter(Year >= 1960)
colnames(df)
df[df==0] <- NA
df$Country[duplicated(cbind(df$Country, df$Year))]
df <- df[!duplicated(cbind(df$Country, df$Year)),]
df <- df[order(df$Country, df$Year),]
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_net_lag1 = dplyr::lag(IV_fdi_net,k=1)) %>%
mutate(IV_fdi_net_pc = (IV_fdi_net-IV_fdi_net_lag1)/IV_fdi_net_lag1*100) %>%
mutate(IV_fdi_net_pc_lag1 = dplyr::lag(IV_fdi_net_pc,k=1)) %>%
mutate(IV_fdi_net_pc_lag2 = dplyr::lag(IV_fdi_net_pc,k=2)) %>%
ungroup()
turn_na <- function(a){
a[abs(a)>10^10] <- NA
a
}
for(i in 2:length(df)){
df[,i] <- lapply(df[,i], turn_na)
}
for(i in 3:length(df)){
result <- paste0(colnames(df[,i]), " has ", sum(is.na(df[,i])), " NAs.")
print(result)
}
library(ggplot2)
va <- select(df,
Year, Country, DV_VA)
va <- na.omit(va)
ggplot(data=va, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_VA)) +
scale_fill_gradient2(midpoint=500000,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
rm(va)
library(ggplot2)
nfc <- select(df,
Year, Country, DV_nfc_ls)
nfc <- na.omit(nfc)
ggplot(data=nfc, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_nfc_ls)) +
scale_fill_gradient2(midpoint=1e+6,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
rm(nfc)
library(ggplot2)
hh <- select(df,
Year, Country, DV_hh_ls)
hh <- na.omit(hh)
ggplot(data=hh, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_hh_ls)) +
scale_fill_gradient2(midpoint=8e+5,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
rm(hh)
"adf" <- function(x,k = 0, int = TRUE, trend = FALSE){
# NB:  returns conventional lm summary so p-values for adf test are wrong!
require(dynlm)
dx <- diff(x)
formula <- paste("dx ~ L(x)")
if(k > 0)
formula <- paste(formula," + L(dx,1:k)")
if(trend){
s <- time(x)
t <- ts(s - s[1],start = s[1],freq = frequency(x))
formula <- paste(formula," + t")
}
if(!int) formula <- paste(formula," - 1")
summary(dynlm(as.formula(formula)))
}
adf_test <- function(df, x, k = k){
result <- data.frame(country = c(),
lx_t = c(),
lx_p = c(),
stationarity = c())
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
iv$Country <- as.character(iv$Country)
country <- data.frame(table(iv$Country))[,1]
for(i in 1:length(country)){
countryname = as.character(country[i])
temp <- iv %>%
filter(Country == countryname)
adf_iv <- ts(temp[,3])
adf(adf_iv, k = k, int = T, trend = T) -> adf_model
adf_model$coefficient[2,3] -> lx_t
adf_model$coefficient[2,4] -> lx_p
stationarity = c()
stationarity[lx_p < 0.05] <- "stationarity"
stationarity[lx_p > 0.05] <- "non-stationarity"
newrow <- c(countryname, lx_t, lx_p, stationarity)
result <- rbind(result, newrow)
}
colnames(result) <- c("country","lx_t","lx_p","stationarity")
print(result)
}
VA_adf <- adf_test(df,"DV_VA",1)
nfc_adf <- adf_test(df,"DV_nfc_ls",1)
hh_adf <- adf_test(df,"DV_hh_ls",1)
variety <- merge(VA_adf, nfc_adf, by = "country", all.y = T)
variety <- merge(variety, hh_adf, by = "country", all.y = T)
variety <- select(variety,
country, stationarity.x, stationarity.y, stationarity)
variety <- variety[,c("country", "stationarity.x", "stationarity.y", "stationarity")]
colnames(variety) <- c("country", "va", "nfc", "hh")
variety
p_load(fBasics,fUnitRoots)
if (!require("punitroots"))install.packages("punitroots", repos="http://R-Forge.R-project.org")
if (!require("CADFtest"))install.packages("CADFtest")
#install.packages("ua")
library(punitroots)
padf <- function(df, x){
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
result = pCADFtest(Y=iv, max.lag.y = 5, criterion = "AIC", crosscorr=0.10)
print(result)
}
VA_padf <- padf(df,"DV_VA_pc")
nfc_padf <- padf(df,"DV_nfc_ls_pc")
hh_padf <- padf(df,"DV_hh_ls_pc")
lending_padf <- padf(df, "IV_lending_pc")
govexp_padf <- padf(df, "IV_gov_exp_pc")
trade_balance_padf <- padf(df, "IV_trade_balance_pc")
fdi_net_padf <- padf(df, "IV_fdi_net_pc")
library(tseries)
po.test(as.matrix(cbind(df$DV_VA_pc, df$IV_lending_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_VA_pc, df$IV_gov_exp_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_VA_pc, df$IV_trade_balance_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_VA_pc, df$IV_fdi_net_pc), demean=FALSE))
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'random')
phtest(m1, m1_re)
fit <- fitted(m1)
fit
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VA._pc ~  DV_VA._pc_lag1 +
IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA._pc ~  DV_VA._pc_lag1 +
IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'random')
phtest(m1, m1_re)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_RVA_pc ~  DV_RVA_pc_lag1 +
IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA._pc ~  DV_VA._pc_lag1 +
IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'random')
phtest(m1, m1_re)
library(tseries)
po.test(as.matrix(cbind(df$DV_nfc_ls_pc, df$IV_lending_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_nfc_ls_pc, df$IV_gov_exp_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_nfc_ls_pc, df$IV_trade_balance_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_nfc_ls_pc, df$IV_fdi_net_pc), demean=FALSE))
po.test(as.matrix(cbind(df$DV_nfc_ls_pc, df$IV_wgini_pc), demean=FALSE))
