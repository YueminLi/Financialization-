aggregate(. ~ Country + Year, data = va, sum) -> va
va[va==0] <- NA
va <- va[!is.na(va$DV_VAplus),]
library(tseries)
po.test(as.matrix(cbind(va$DV_VAplus, va$IV_lendingplus), demean=FALSE))
#po.test(as.matrix(cbind(va$DV_VAplus, va$IV_gov_expplus), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VAplus, va$IV_trade_balanceplus), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VAplus, va$IV_fdi_outflowplus), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VAplus, va$IV_giniplus), demean=FALSE))
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VAplus ~  DV_VAplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#                       IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_giniplus + IV_giniplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus + IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus +
C_REER + C_gdp + C_cpi,
data = va, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VAplus ~  DV_VAplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#                      IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_giniplus +  IV_giniplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus +IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
C_REER + C_gdp + C_cpi,
data = va, model = 'random')
#hh_country <- na.omit(variety$country[variety$hh == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_hh_lsplus, DV_hh_lsplus_lag1,
IV_lendingplus, IV_gov_expplus, IV_trade_balanceplus, IV_fdi_outflowplus, IV_giniplus,
IV_lendingplus_lag1, IV_gov_expplus_lag1,
IV_trade_balanceplus_lag1, IV_fdi_outflowplus_lag1,
IV_giniplus_lag1,
C_m2plus, C_REERplus, C_cpiplus, C_gdpplus,
C_REER, C_gdp, C_cpi) -> hh
#hh <- hh[hh$Country %in% hh_country,]
hh[is.na(hh)] <- 0
aggregate(. ~ Country + Year, data = hh, sum) -> hh
hh[hh ==0] <- NA
hh <- hh[!is.na(hh$DV_hh_lsplus),]
#hh_country
library(tseries)
po.test(as.matrix(cbind(nfc$DV_nfc_lsplus, nfc$IV_lendingplus), demean=FALSE))
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m3  <- plm(DV_hh_lsplus ~  DV_hh_lsplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#  IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_giniplus + IV_giniplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus + IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
C_REER + C_gdp + C_cpi,
data = hh, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m3)
# PCSE
summary(m3, vcovBK)
# Durbin-Watson Statistics
pdwtest(m3)
# m1_re is a RE model
m3_re  <- plm(DV_hh_lsplus ~  DV_hh_lsplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
# IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_giniplus +  IV_giniplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus +IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
data = hh, model = 'random')
phtest(m3, m3_re)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m3  <- plm(DV_hh_lsplus ~  DV_hh_lsplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#  IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_giniplus + IV_giniplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus + IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
C_REER + C_gdp + C_cpi,
data = hh, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m3)
# PCSE
summary(m3, vcovBK)
# Durbin-Watson Statistics
pdwtest(m3)
# m1_re is a RE model
m3_re  <- plm(DV_hh_lsplus ~  DV_hh_lsplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
# IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_giniplus +  IV_giniplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus +IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
C_REER + C_gdp + C_cpi,
data = hh, model = 'random')
phtest(m3, m3_re)
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("../data_processing/financialization_df.csv")
df$X <- NULL
df <- df %>%
filter(Year >= 1960)
colnames(df)
df <- df %>%
group_by(Country) %>%
mutate(IV_gini_lag1 = dplyr::lag(IV_gini,k=1)) %>%
mutate(IV_giniplus = (IV_gini-IV_gini_lag1)/IV_gini_lag1*100) %>%
mutate(IV_giniplus_lag1 = dplyr::lag(IV_giniplus,k=1)) %>%
mutate(IV_giniplus_lag2 = dplyr::lag(IV_giniplus,k=2)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_outflow_lag1 = dplyr::lag(IV_fdi_outflow,k=1)) %>%
mutate(IV_fdi_outflowplus = (IV_fdi_outflow-IV_fdi_outflow_lag1)/IV_fdi_outflow_lag1*100) %>%
mutate(IV_fdi_outflowplus_lag1 = dplyr::lag(IV_fdi_outflowplus,k=1)) %>%
ungroup()
turn_na <- function(a){
a[abs(a)>10^10] <- NA
a
}
for(i in 2:length(df)){
df[,i] <- lapply(df[,i], turn_na)
}
for(i in 3:length(df)){
result <- paste0(colnames(df[,i]), " has ", sum(is.na(df[,i])), " NAs.")
print(result)
}
"adf" <- function(x,k = 0, int = TRUE, trend = FALSE){
# NB:  returns conventional lm summary so p-values for adf test are wrong!
require(dynlm)
dx <- diff(x)
formula <- paste("dx ~ L(x)")
if(k > 0)
formula <- paste(formula," + L(dx,1:k)")
if(trend){
s <- time(x)
t <- ts(s - s[1],start = s[1],freq = frequency(x))
formula <- paste(formula," + t")
}
if(!int) formula <- paste(formula," - 1")
summary(dynlm(as.formula(formula)))
}
adf_test <- function(df, x, k = k){
result <- data.frame(country = c(),
lx_t = c(),
lx_p = c(),
stationarity = c())
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
iv$Country <- as.character(iv$Country)
country <- data.frame(table(iv$Country))[,1]
for(i in 1:length(country)){
countryname = as.character(country[i])
temp <- iv %>%
filter(Country == countryname)
adf_iv <- ts(temp[,3])
adf(adf_iv, k = k, int = T, trend = T) -> adf_model
adf_model$coefficient[2,3] -> lx_t
adf_model$coefficient[2,4] -> lx_p
stationarity = c()
stationarity[lx_p < 0.05] <- "stationarity"
stationarity[lx_p > 0.05] <- "non-stationarity"
newrow <- c(countryname, lx_t, lx_p, stationarity)
result <- rbind(result, newrow)
}
colnames(result) <- c("country","lx_t","lx_p","stationarity")
print(result)
}
VA_adf <- adf_test(df,"DV_VA",1)
nfc_adf <- adf_test(df,"DV_nfc_ls",1)
hh_adf <- adf_test(df,"DV_hh_ls",1)
variety <- merge(VA_adf, nfc_adf, by = "country", all.y = T)
variety <- merge(variety, hh_adf, by = "country", all.y = T)
variety <- select(variety,
country, stationarity.x, stationarity.y, stationarity)
variety <- variety[,c("country", "stationarity.x", "stationarity.y", "stationarity")]
colnames(variety) <- c("country", "va", "nfc", "hh")
variety
p_load(fBasics,fUnitRoots)
if (!require("punitroots"))install.packages("punitroots", repos="http://R-Forge.R-project.org")
if (!require("CADFtest"))install.packages("CADFtest")
#install.packages("ua")
library(punitroots)
padf <- function(df, x){
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
result = pCADFtest(Y=iv, max.lag.y = 5, criterion = "AIC", crosscorr=0.10)
print(result)
}
VA_padf <- padf(df,"DV_VAplus")
nfc_padf <- padf(df,"DV_nfc_lsplus")
hh_padf <- padf(df,"DV_hh_lsplus")
lending_padf <- padf(df, "IV_lendingplus")
govexp_padf <- padf(df, "IV_gov_expplus")
gini_padf <- padf(df, "IV_giniplus")
trade_balance_padf <- padf(df, "IV_trade_balanceplus")
fdi_outflow_padf <- padf(df, "IV_fdi_outflowplus")
#VA_country <- na.omit(variety$country[variety$va == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_VAplus, DV_VAplus_lag1,
IV_lendingplus, IV_gov_expplus, IV_trade_balanceplus, IV_fdi_outflowplus, IV_giniplus,
IV_lendingplus_lag1, IV_gov_expplus_lag1,
IV_trade_balanceplus_lag1, IV_fdi_outflowplus_lag1,
IV_giniplus_lag1, C_REER, C_gdp, C_cpi,
C_m2plus, C_REERplus, C_cpiplus, C_gdpplus) -> va
#va[va$Country %in% VA_country,] -> va
va[is.na(va)] <- 0
aggregate(. ~ Country + Year, data = va, sum) -> va
va[va==0] <- NA
va <- va[!is.na(va$DV_VAplus),]
library(tseries)
po.test(as.matrix(cbind(va$DV_VAplus, va$IV_lendingplus), demean=FALSE))
#po.test(as.matrix(cbind(va$DV_VAplus, va$IV_gov_expplus), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VAplus, va$IV_trade_balanceplus), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VAplus, va$IV_fdi_outflowplus), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VAplus, va$IV_giniplus), demean=FALSE))
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VAplus ~  DV_VAplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#                       IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_giniplus + IV_giniplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus + IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus +
C_REER + C_gdp + C_cpi,
data = va, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VAplus ~  DV_VAplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#                      IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_giniplus +  IV_giniplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus +IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
C_REER + C_gdp + C_cpi,
data = va, model = 'random')
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("../data_processing/financialization_df.csv")
df$X <- NULL
df <- df %>%
filter(Year >= 1960)
colnames(df)
df <- df %>%
group_by(Country) %>%
mutate(IV_gini_lag1 = dplyr::lag(IV_gini,k=1)) %>%
mutate(IV_giniplus = (IV_gini-IV_gini_lag1)/IV_gini_lag1*100) %>%
mutate(IV_giniplus_lag1 = dplyr::lag(IV_giniplus,k=1)) %>%
mutate(IV_giniplus_lag2 = dplyr::lag(IV_giniplus,k=2)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_outflow_lag1 = dplyr::lag(IV_fdi_outflow,k=1)) %>%
mutate(IV_fdi_outflowplus = (IV_fdi_outflow-IV_fdi_outflow_lag1)/IV_fdi_outflow_lag1*100) %>%
mutate(IV_fdi_outflowplus_lag1 = dplyr::lag(IV_fdi_outflowplus,k=1)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_wgini_lag1 = dplyr::lag(IV_wgini,k=1)) %>%
mutate(IV_wginiplus = (IV_wgini-IV_gwini_lag1)/IV_wgini_lag1*100) %>%
mutate(IV_wginiplus_lag1 = dplyr::lag(IV_wginiplus,k=1)) %>%
mutate(IV_wginiplus_lag2 = dplyr::lag(IV_wginiplus,k=2)) %>%
ungroup()
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("../data_processing/financialization_df.csv")
df$X <- NULL
df <- df %>%
filter(Year >= 1960)
colnames(df)
df <- df %>%
group_by(Country) %>%
mutate(IV_gini_lag1 = dplyr::lag(IV_gini,k=1)) %>%
mutate(IV_giniplus = (IV_gini-IV_gini_lag1)/IV_gini_lag1*100) %>%
mutate(IV_giniplus_lag1 = dplyr::lag(IV_giniplus,k=1)) %>%
mutate(IV_giniplus_lag2 = dplyr::lag(IV_giniplus,k=2)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_outflow_lag1 = dplyr::lag(IV_fdi_outflow,k=1)) %>%
mutate(IV_fdi_outflowplus = (IV_fdi_outflow-IV_fdi_outflow_lag1)/IV_fdi_outflow_lag1*100) %>%
mutate(IV_fdi_outflowplus_lag1 = dplyr::lag(IV_fdi_outflowplus,k=1)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_wgini_lag1 = dplyr::lag(IV_wgini,k=1)) %>%
mutate(IV_wginiplus = (IV_wgini-IV_gwini_lag1)/IV_wgini_lag1*100) %>%
mutate(IV_wginiplus_lag1 = dplyr::lag(IV_wginiplus,k=1)) %>%
mutate(IV_wginiplus_lag2 = dplyr::lag(IV_wginiplus,k=2)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_wgini_lag1 = dplyr::lag(IV_wgini,k=1)) %>%
mutate(IV_wginiplus = (IV_wgini-IV_wgini_lag1)/IV_wgini_lag1*100) %>%
mutate(IV_wginiplus_lag1 = dplyr::lag(IV_wginiplus,k=1)) %>%
mutate(IV_wginiplus_lag2 = dplyr::lag(IV_wginiplus,k=2)) %>%
ungroup()
turn_na <- function(a){
a[abs(a)>10^10] <- NA
a
}
for(i in 2:length(df)){
df[,i] <- lapply(df[,i], turn_na)
}
for(i in 3:length(df)){
result <- paste0(colnames(df[,i]), " has ", sum(is.na(df[,i])), " NAs.")
print(result)
}
padf <- function(df, x){
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
result = pCADFtest(Y=iv, max.lag.y = 5, criterion = "AIC", crosscorr=0.10)
print(result)
}
VA_padf <- padf(df,"DV_VAplus")
p_load(fBasics,fUnitRoots)
if (!require("punitroots"))install.packages("punitroots", repos="http://R-Forge.R-project.org")
if (!require("CADFtest"))install.packages("CADFtest")
#install.packages("ua")
library(punitroots)
padf <- function(df, x){
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
result = pCADFtest(Y=iv, max.lag.y = 5, criterion = "AIC", crosscorr=0.10)
print(result)
}
VA_padf <- padf(df,"DV_VAplus")
nfc_padf <- padf(df,"DV_nfc_lsplus")
hh_padf <- padf(df,"DV_hh_lsplus")
lending_padf <- padf(df, "IV_lendingplus")
govexp_padf <- padf(df, "IV_gov_expplus")
gini_padf <- padf(df, "IV_giniplus")
wgini_padf <- padf(df, "IV_wginiplus")
trade_balance_padf <- padf(df, "IV_trade_balanceplus")
fdi_outflow_padf <- padf(df, "IV_fdi_outflowplus")
#VA_country <- na.omit(variety$country[variety$va == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_VAplus, DV_VAplus_lag1,
IV_lendingplus, IV_gov_expplus, IV_trade_balanceplus, IV_fdi_outflowplus, IV_wginiplus,
IV_lendingplus_lag1, IV_gov_expplus_lag1,
IV_trade_balanceplus_lag1, IV_fdi_outflowplus_lag1,
IV_wginiplus_lag1, C_REER, C_wgdp, C_cpi,
C_m2plus, C_REERplus, C_cpiplus, C_wgdpplus) -> va
#VA_country <- na.omit(variety$country[variety$va == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_VAplus, DV_VAplus_lag1,
IV_lendingplus, IV_gov_expplus, IV_trade_balanceplus, IV_fdi_outflowplus, IV_wginiplus,
IV_lendingplus_lag1, IV_gov_expplus_lag1,
IV_trade_balanceplus_lag1, IV_fdi_outflowplus_lag1,
IV_wginiplus_lag1, C_REER, C_wgdp, C_cpi,
C_m2plus, C_REERplus, C_wgdpplus) -> va
#va[va$Country %in% VA_country,] -> va
va[is.na(va)] <- 0
aggregate(. ~ Country + Year, data = va, sum) -> va
va[va==0] <- NA
va <- va[!is.na(va$DV_VAplus),]
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VAplus ~  DV_VAplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#                       IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_wginiplus + IV_wginiplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus + IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus +
C_REER + C_wgdp + C_cpi,
data = va, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VAplus ~  DV_VAplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#                      IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_wginiplus +  IV_wginiplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus +IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
C_REER + C_wgdp + C_cpi,
data = va, model = 'random')
phtest(m1, m1_re)
#nfc_country <- na.omit(variety$country[variety$nfc == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_nfc_lsplus, DV_nfc_lsplus_lag1,
IV_lendingplus, IV_gov_expplus, IV_trade_balanceplus, IV_fdi_outflowplus, IV_wginiplus,
IV_lendingplus_lag1, IV_gov_expplus_lag1,
IV_trade_balanceplus_lag1, IV_fdi_outflowplus_lag1,
IV_wginiplus_lag1, C_m2plus, C_REERplus, C_wgdpplus, C_REER, C_wgdp, C_cpi) -> nfc
#nfc <- nfc[nfc$Country %in% nfc_country,]
nfc[is.na(nfc)] <- 0
aggregate(. ~ Country + Year, data = nfc, sum) -> nfc
nfc[nfc ==0] <- NA
nfc <- nfc[!is.na(nfc$DV_nfc_lsplus),]
#nfc_country
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m2  <- plm(DV_nfc_lsplus ~  DV_nfc_lsplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#  IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_wginiplus + IV_wginiplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus + IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
C_REER + C_wgdp + C_cpi,
data = nfc, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m2)
# PCSE
summary(m2, vcovBK)
# Durbin-Watson Statistics
pdwtest(m2)
# m1_re is a RE model
m2_re  <- plm(DV_nfc_lsplus ~  DV_nfc_lsplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
# IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_wginiplus +  IV_wginiplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus +IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
# C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
C_REER + C_wgdp + C_cpi,
data = nfc, model = 'random')
phtest(m2, m2_re)
#hh_country <- na.omit(variety$country[variety$hh == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_hh_lsplus, DV_hh_lsplus_lag1,
IV_lendingplus, IV_gov_expplus, IV_trade_balanceplus, IV_fdi_outflowplus, IV_wginiplus,
IV_lendingplus_lag1, IV_gov_expplus_lag1,
IV_trade_balanceplus_lag1, IV_fdi_outflowplus_lag1,
IV_wginiplus_lag1,
C_m2plus, C_REERplus, C_wgdpplus,
C_REER, C_wgdp, C_cpi) -> hh
#hh <- hh[hh$Country %in% hh_country,]
hh[is.na(hh)] <- 0
aggregate(. ~ Country + Year, data = hh, sum) -> hh
hh[hh ==0] <- NA
hh <- hh[!is.na(hh$DV_hh_lsplus),]
#hh_country
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m3  <- plm(DV_hh_lsplus ~  DV_hh_lsplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#  IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_wginiplus + IV_wginiplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus + IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
C_REER + C_wgdp + C_cpi,
data = hh, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m3)
# PCSE
summary(m3, vcovBK)
# Durbin-Watson Statistics
pdwtest(m3)
# m1_re is a RE model
m3_re  <- plm(DV_hh_lsplus ~  DV_hh_lsplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
# IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_wginiplus +  IV_wginiplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus +IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
#C_m2plus + C_REERplus + C_gdpplus + C_cpiplus,
C_REER + C_wgdp + C_cpi,
data = hh, model = 'random')
phtest(m3, m3_re)
