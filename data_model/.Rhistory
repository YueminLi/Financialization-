C_REER + C_wgdp + C_cpi,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m3)
# PCSE
summary(m3, vcovBK)
# Durbin-Watson Statistics
pdwtest(m3)
# m1_re is a RE model
m3_re  <- plm(DV_hh_ls._pc ~  DV_hh_ls._pc_lag1 +
IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi,
data = df, model = 'random')
phtest(m3, m3_re)
# po data
po <- cbind (po =c("Government net lending", "Government expenditure", "Net trade balance", "FDI net outflow"),
va = po_va,
nfc = po_nfc,
hh = po_hh)
colnames(po) <- c("po","va", "nfc", "hh")
write.csv(po, "../table_and_figure/po.csv")
# model data
p_load(gtools)
options(scipen = 999)
m1r <- data.frame(summary(m1)[1])
m1r <- rbind(c(NA, NA), m1r)
m1r$star <- stars.pval(m1r[,4])
m1r[,1] <- format(round(m1r[,1], digit = 4))
m1r[,1] <- paste(m1r[,1], m1r[,5])
m1r <- m1r[1:2]
m2r <- data.frame(summary(m2_re)[1])
m2r$star <- stars.pval(m2r[,4])
m2r[,1] <- format(round(m2r[,1], digit = 4))
m2r[,1] <- paste(m2r[,1], m2r[,5])
m2r <- m2r[1:2]
m3r <- data.frame(summary(m3)[1])
m3r <- rbind(c(NA, NA), m3r)
m3r$star <- stars.pval(m3r[,4])
m3r[,1] <- format(round(m3r[,1], digit = 4))
m3r[,1] <- paste(m3r[,1], m3r[,5])
m3r <- m3r[1:2]
# m1r <- data.frame(summary(m1)[1])[c(1:2, 4)]
# m1r <- rbind(c(NA, NA, NA), m1r)
# m2r <- data.frame(summary(m2_re)[1])[c(1:2,4)]
# m3r <- data.frame(summary(m3)[1])[c(1:2,4)]
# m3r <- rbind(c(NA, NA, NA), m3r)
#
model <- cbind(m1r, m2r, m3r)
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("../data_processing/financialization_df.csv")
df$X <- NULL
df <- df %>%
filter(Year >= 1960)
colnames(df)
df[df==0] <- NA
df$Country[duplicated(cbind(df$Country, df$Year))]
df <- df[!duplicated(cbind(df$Country, df$Year)),]
df <- df[order(df$Country, df$Year),]
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_net_lag1 = dplyr::lag(IV_fdi_net,k=1)) %>%
mutate(IV_fdi_net_pc = (IV_fdi_net-IV_fdi_net_lag1)/IV_fdi_net_lag1*100) %>%
mutate(IV_fdi_net_pc_lag1 = dplyr::lag(IV_fdi_net_pc,k=1)) %>%
mutate(IV_fdi_net_pc_lag2 = dplyr::lag(IV_fdi_net_pc,k=2)) %>%
ungroup()
turn_na <- function(a){
a[abs(a)>10^10] <- NA
a
}
for(i in 2:length(df)){
df[,i] <- lapply(df[,i], turn_na)
}
for(i in 3:length(df)){
result <- paste0(colnames(df[,i]), " has ", sum(is.na(df[,i])), " NAs.")
print(result)
}
library(ggplot2)
va <- select(df,
Year, Country, DV_VA)
va <- na.omit(va)
ggplot(data=va, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_VA)) +
scale_fill_gradient2(midpoint=500000,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
rm(va)
library(ggplot2)
nfc <- select(df,
Year, Country, DV_nfc_ls)
nfc <- na.omit(nfc)
ggplot(data=nfc, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_nfc_ls)) +
scale_fill_gradient2(midpoint=1e+6,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
rm(nfc)
library(ggplot2)
hh <- select(df,
Year, Country, DV_hh_ls)
hh <- na.omit(hh)
ggplot(data=hh, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_hh_ls)) +
scale_fill_gradient2(midpoint=8e+5,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
rm(hh)
"adf" <- function(x,k = 0, int = TRUE, trend = FALSE){
# NB:  returns conventional lm summary so p-values for adf test are wrong!
require(dynlm)
dx <- diff(x)
formula <- paste("dx ~ L(x)")
if(k > 0)
formula <- paste(formula," + L(dx,1:k)")
if(trend){
s <- time(x)
t <- ts(s - s[1],start = s[1],freq = frequency(x))
formula <- paste(formula," + t")
}
if(!int) formula <- paste(formula," - 1")
summary(dynlm(as.formula(formula)))
}
adf_test <- function(df, x, k = k){
result <- data.frame(country = c(),
lx_t = c(),
lx_p = c(),
stationarity = c())
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
iv$Country <- as.character(iv$Country)
country <- data.frame(table(iv$Country))[,1]
for(i in 1:length(country)){
countryname = as.character(country[i])
temp <- iv %>%
filter(Country == countryname)
adf_iv <- ts(temp[,3])
adf(adf_iv, k = k, int = T, trend = T) -> adf_model
adf_model$coefficient[2,3] -> lx_t
adf_model$coefficient[2,4] -> lx_p
stationarity = c()
stationarity[lx_p < 0.05] <- "stationarity"
stationarity[lx_p > 0.05] <- "non-stationarity"
newrow <- c(countryname, lx_t, lx_p, stationarity)
result <- rbind(result, newrow)
}
colnames(result) <- c("country","lx_t","lx_p","stationarity")
print(result)
}
VA_adf <- adf_test(df,"DV_VA",1)
nfc_adf <- adf_test(df,"DV_nfc_ls",1)
hh_adf <- adf_test(df,"DV_hh_ls",1)
variety <- merge(VA_adf, nfc_adf, by = "country", all.y = T)
variety <- merge(variety, hh_adf, by = "country", all.y = T)
variety <- select(variety,
country, stationarity.x, stationarity.y, stationarity)
variety <- variety[,c("country", "stationarity.x", "stationarity.y", "stationarity")]
colnames(variety) <- c("country", "va", "nfc", "hh")
variety
p_load(fBasics,fUnitRoots)
if (!require("punitroots"))install.packages("punitroots", repos="http://R-Forge.R-project.org")
if (!require("CADFtest"))install.packages("CADFtest")
#install.packages("ua")
library(punitroots)
model_country <- c("Australia", "Austria", "Belgium", "Brazil", "Canada",
"Chile", "China", "Denmark", "Finland", "France",
"Germany", "Greece", "Hungary", "Iceland", "Ireland",
"Israel","Italy", "Japan", "Korea", "Mexico",
"Netherlands", "New Zealand", "Norway", "Poland", "Portugal",
"Spain", "Sweden", "Switzerland", "Turkey", "United Kingdom",
"United States")
df_model <- df[df$Country %in% model_country,]
padf <- function(df, x){
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
result = pCADFtest(Y=iv, max.lag.y = 5, criterion = "AIC", crosscorr=0.10)
print(result)
}
VA_padf <- padf(df,"DV_VA_pc")
nfc_padf <- padf(df,"DV_nfc_ls_pc")
hh_padf <- padf(df,"DV_hh_ls_pc")
lending_padf <- padf(df, "IV_lending_pc")
govexp_padf <- padf(df, "IV_gov_exp_pc")
trade_balance_padf <- padf(df, "IV_trade_balance_pc")
fdi_net_padf <- padf(df, "IV_fdi_net_pc")
rbind(as.numeric(VA_padf[1]), as.numeric(nfc_padf[1]), as.numeric(hh_padf[1]),
as.numeric(lending_padf[1]), as.numeric(govexp_padf[1]), as.numeric(trade_balance_padf[1]),
as.numeric(fdi_net_padf[1])) -> ADF_statistics
rbind(as.numeric(VA_padf[4]), as.numeric(nfc_padf[4]), as.numeric(hh_padf[4]),
as.numeric(lending_padf[4]), as.numeric(govexp_padf[4]), as.numeric(trade_balance_padf[4]),
as.numeric(fdi_net_padf[4])) -> P_value
variable <- c("Values added in financial activities", "Nonfinancial corporate debts", "Household debts",
"Government net lending", "Government expenditure", "Net trade balance", "FDI net outflow")
padf_table <- data.frame(cbind(variable, ADF_statistics, P_value))
colnames(padf_table) <- c("Variable", "ADF_statistics", "P_value")
write.csv(padf_table, "../table_and_figure/padf_table.csv")
cor_df <- df_model %>%
select(DV_VA_pc,DV_nfc_ls_pc,DV_hh_ls_pc,
IV_lending_pc, IV_gov_exp_pc,IV_trade_balance_pc,IV_fdi_net_pc)
cor_mat <- cor(cor_df, use = 'na')
cor_mat[upper.tri(cor_mat)] <- NA
cor_mat
write.csv(cor_mat, '../table_and_figure/cor_mat.csv')
va_df <- df_model %>%
select(DV_VA_pc,DV_VA_pc_lag1,
IV_lending_pc, IV_lending_pc_lag1,
IV_gov_exp_pc, IV_gov_exp_pc_lag1,
IV_trade_balance_pc, IV_trade_balance_pc_lag1,
IV_fdi_net_pc, IV_fdi_net_pc_lag1,
C_REER, C_wgdp, C_cpi, C_wgini,
Country, Year)
va_df <- na.omit(va_df)
library(tseries)
po.test(as.matrix(cbind(va_df$DV_VA_pc, va_df$IV_lending_pc), demean=FALSE)) -> po_va_lending
po.test(as.matrix(cbind(va_df$DV_VA_pc, va_df$IV_gov_exp_pc), demean=FALSE)) -> po_va_exp
po.test(as.matrix(cbind(va_df$DV_VA_pc, va_df$IV_trade_balance_pc), demean=FALSE)) -> po_va_trade
po.test(as.matrix(cbind(va_df$DV_VA_pc, va_df$IV_fdi_net_pc), demean=FALSE)) -> po_va_fdi
po_va <- rbind(as.numeric(po_va_lending[1]), as.numeric(po_va_exp[1]),
as.numeric(po_va_trade[1]), as.numeric(po_va_fdi[1]))
po_va
# m1 is an FE model
m1  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'random')
phtest(m1, m1_re)
fit <- fitted(m1)
fit
# # m1_p is an FE model
# m1_p  <- plm(DV_VA._pc ~  DV_VA._pc_lag1 +
#                         IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
#                         IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
#                         IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
#                         IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#                         C_REER + C_wgdp + C_cpi,
#           data = df, model = 'within',
#           effect = 'twoways', index = c('Country', 'Year'))
# summary(m1_p)
#
# # PCSE
# summary(m1_p, vcovBK)
#
# # Durbin-Watson Statistics
# pdwtest(m1_p)
#
# # m1_p_re is a RE model
# m1_re_p  <- plm(DV_VA._pc ~  DV_VA._pc_lag1 +
#                         IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
#                         IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
#                         IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
#                         IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#                         C_REER + C_wgdp + C_cpi,
#           data = df, model = 'random')
# phtest(m1_p, m1_re_p)
# # m1 is an FE model
# m1_r  <- plm(DV_RVA_pc ~  DV_RVA_pc_lag1 +
#                         IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
#                         IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
#                         IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
#                         IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#                         C_REER + C_wgdp + C_cpi + C_wgini,
#           data = df, model = 'within',
#           effect = 'twoways', index = c('Country', 'Year'))
# summary(m1_r)
#
# # PCSE
# summary(m1_r, vcovBK)
#
# # Durbin-Watson Statistics
# pdwtest(m1_r)
#
# # m1_re_r is a RE model
# m1_re_r  <- plm(DV_VA._pc ~  DV_VA._pc_lag1 +
#                         IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
#                         IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
#                         IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
#                         IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#                 C_REER + C_wgdp + C_cpi + C_wgini,
#           data = df, model = 'random')
# phtest(m1_r, m1_re_r)
nfc_df <- df_model %>%
select(DV_nfc_ls_pc,DV_nfc_ls_pc_lag1,
IV_lending_pc, IV_lending_pc_lag1,
IV_gov_exp_pc, IV_gov_exp_pc_lag1,
IV_trade_balance_pc, IV_trade_balance_pc_lag1,
IV_fdi_net_pc, IV_fdi_net_pc_lag1,
C_REER, C_wgdp, C_cpi, C_wgini,
Country, Year)
nfc_df <- na.omit(nfc_df)
library(tseries)
po.test(as.matrix(cbind(nfc_df$DV_nfc_ls_pc, nfc_df$IV_lending_pc), demean=FALSE)) -> po_nfc_lending
po.test(as.matrix(cbind(nfc_df$DV_nfc_ls_pc, nfc_df$IV_gov_exp_pc), demean=FALSE)) -> po_nfc_exp
po.test(as.matrix(cbind(nfc_df$DV_nfc_ls_pc, nfc_df$IV_trade_balance_pc), demean=FALSE)) -> po_nfc_trade
po.test(as.matrix(cbind(nfc_df$DV_nfc_ls_pc, nfc_df$IV_fdi_net_pc), demean=FALSE)) -> po_nfc_fdi
#po.test(as.matrix(cbind(nfc_df$DV_nfc_ls_pc, nfc_df$IV_wgini_pc), demean=FALSE))
po_nfc <- rbind(as.numeric(po_nfc_lending[1]), as.numeric(po_nfc_exp[1]),
as.numeric(po_nfc_trade[1]), as.numeric(po_nfc_fdi[1]))
po_nfc
nfc <- df %>%
select(IV_gov_exp_pc, IV_gov_exp_pc_lag1,
IV_trade_balance_pc, IV_trade_balance_pc_lag1,
IV_fdi_net_pc, IV_fdi_net_pc_lag1,
C_REER, C_wgdp, C_cpi)
cor(nfc, method = "pearson", use = "na")
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m2  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m2)
# PCSE
summary(m2, vcovBK)
# Durbin-Watson Statistics
pdwtest(m2)
# m1_re is a RE model
m2_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'random')
phtest(m2, m2_re)
# library(Matrix)
# library(plm)
# library(car)
# library(lmtest)
#
# # m1 is an FE model
# m2_p  <- plm(DV_nfc_ls._pc ~  DV_nfc_ls._pc_lag1 +
#                                    IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
#             IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
#              IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
#              IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#              C_REER + C_wgdp + C_cpi,
#            data = df, model = 'within',
#            effect = 'twoways', index = c('Country', 'Year'))
# summary(m2)
#
# # PCSE
# summary(m2, vcovBK)
#
# # Durbin-Watson Statistics
# pdwtest(m2)
#
# # m1_re is a RE model
# m2_re_p  <- plm(DV_nfc_ls._pc ~  DV_nfc_ls._pc_lag1 +
#                                   IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
#              IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
#              IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
#              IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#              C_REER + C_wgdp + C_cpi,
#            data = df, model = 'random')
# phtest(m2, m2_re)
hh_df <- df_model %>%
select(DV_hh_ls_pc,DV_hh_ls_pc_lag1,
IV_lending_pc, IV_lending_pc_lag1,
IV_gov_exp_pc, IV_gov_exp_pc_lag1,
IV_trade_balance_pc, IV_trade_balance_pc_lag1,
IV_fdi_net_pc, IV_fdi_net_pc_lag1,
C_REER, C_wgdp, C_cpi, C_wgini,
Country, Year)
hh_df <- na.omit(hh_df)
library(tseries)
po.test(as.matrix(cbind(hh_df$DV_hh_ls_pc, hh_df$IV_lending_pc), demean=FALSE)) -> po_hh_lending
po.test(as.matrix(cbind(hh_df$DV_hh_ls_pc, hh_df$IV_gov_exp_pc), demean=FALSE)) -> po_hh_exp
po.test(as.matrix(cbind(hh_df$DV_hh_ls_pc, hh_df$IV_trade_balance_pc), demean=FALSE)) -> po_hh_trade
po.test(as.matrix(cbind(hh_df$DV_hh_ls_pc, hh_df$IV_fdi_net_pc), demean=FALSE)) -> po_hh_fdi
po_hh <- rbind(as.numeric(po_hh_lending[1]), as.numeric(po_hh_exp[1]),
as.numeric(po_hh_trade[1]), as.numeric(po_hh_fdi[1]))
po_hh
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m3  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m3)
# PCSE
summary(m3, vcovBK)
# Durbin-Watson Statistics
pdwtest(m3)
# m1_re is a RE model
m3_re  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
C_REER + C_wgdp + C_cpi + C_wgini,
data = df, model = 'random')
phtest(m3, m3_re)
#
# # m1 is an FE model
# m3_p  <- plm(DV_hh_ls._pc ~  DV_hh_ls._pc_lag1 +
#                        IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
#                        IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
#                         IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
#                         IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#              C_REER + C_wgdp + C_cpi,
#           data = df, model = 'within',
#           effect = 'twoways', index = c('Country', 'Year'))
# summary(m3)
#
# # PCSE
# summary(m3, vcovBK)
#
# # Durbin-Watson Statistics
# pdwtest(m3)
#
# # m1_re is a RE model
# m3_re_p  <- plm(DV_hh_ls._pc ~  DV_hh_ls._pc_lag1 +
#                         IV_lending._pc + IV_lending._pc_lag1 + #IV_lending_pc_lag2 +
#                         IV_gov_exp._pc + IV_gov_exp._pc_lag1 + #IV_gov_exp_pc_lag2 +
#                         IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
#                         IV_fdi_net_pc + IV_fdi_net_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#                 C_REER + C_wgdp + C_cpi,
#           data = df, model = 'random')
# phtest(m3, m3_re)
#
save(m1, m1_re, m2, m2_re, m3, m3_re,
file = "../table_and_figure/model.RData")
# po data
po <- cbind (po =c("Government net lending", "Government expenditure", "Net trade balance", "FDI net outflow"),
va = po_va,
nfc = po_nfc,
hh = po_hh)
colnames(po) <- c("po","va", "nfc", "hh")
write.csv(po, "../table_and_figure/po.csv")
# model data
p_load(gtools)
options(scipen = 999)
m1r <- data.frame(summary(m1)[1])
m1r <- rbind(c(NA, NA), m1r)
m1r$star <- stars.pval(m1r[,4])
m1r[,1] <- format(round(m1r[,1], digit = 4))
m1r[,1] <- paste(m1r[,1], m1r[,5])
m1r <- m1r[1:2]
m2r <- data.frame(summary(m2_re)[1])
m2r$star <- stars.pval(m2r[,4])
m2r[,1] <- format(round(m2r[,1], digit = 4))
m2r[,1] <- paste(m2r[,1], m2r[,5])
m2r <- m2r[1:2]
m3r <- data.frame(summary(m3)[1])
m3r <- rbind(c(NA, NA), m3r)
m3r$star <- stars.pval(m3r[,4])
m3r[,1] <- format(round(m3r[,1], digit = 4))
m3r[,1] <- paste(m3r[,1], m3r[,5])
m3r <- m3r[1:2]
# m1r <- data.frame(summary(m1)[1])[c(1:2, 4)]
# m1r <- rbind(c(NA, NA, NA), m1r)
# m2r <- data.frame(summary(m2_re)[1])[c(1:2,4)]
# m3r <- data.frame(summary(m3)[1])[c(1:2,4)]
# m3r <- rbind(c(NA, NA, NA), m3r)
#
## r-square
m1s <- data.frame(summary(m1)[11])[1,1]
m2s <- data.frame(summary(m2_re)[12])[1,1]
m3s <- data.frame(summary(m3)[11])[1,1]
# N
m1n <- nrow(data.frame((summary(m1)[3])))
m2n <- nrow(data.frame((summary(m2_re)[3])))
m3n <- nrow(data.frame((summary(m3)[3])))
m1r <- rbind(m1r, c(m1s, NA), c(m1n, NA))
m2r <- rbind(m2r, c(m2s, NA), c(m2n, NA))
m3r <- rbind(m3r, c(m3s, NA), c(m3n, NA))
model <- cbind(m1r, m2r, m3r)
model[1,1] <- ""
model[1,5] <- ""
write.csv(model, "../table_and_figure/model.csv")
# # Durbin-Watson
# m1dw <- pdwtest(m1)
# m2dw <- pdwtest(m2_re)
# m3dw <- pdwtest(m3)
#
# m1dw_value <- "()"
options(scipen = 0)
