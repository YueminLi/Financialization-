adf_test(oecd,"IV_lendingplus",1)
adf_test(oecd,"DV_VA",1)
# install.packages("pacman")
library(pacman)
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
load("~/Downloads/NHS_Cleaned_Frame.RData")
setwd("~/Downloads/GitHub/Hegemony_Pitfall_or_Statecraft_Toolkit")
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("../data_processing/financialization_df.csv")
df$X <- NULL
df <- df %>%
filter(Year >= 1960)
colnames(df)
df <- df %>%
group_by(Country) %>%
mutate(IV_gini_lag1 = dplyr::lag(IV_gini,k=1)) %>%
mutate(IV_gini_pc = (IV_gini-IV_gini_lag1)/IV_gini_lag1*100) %>%
mutate(IV_gini_pc_lag1 = dplyr::lag(IV_gini_pc,k=1)) %>%
mutate(IV_gini_pc_lag2 = dplyr::lag(IV_gini_pc,k=2)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_outflow_lag1 = dplyr::lag(IV_fdi_outflow,k=1)) %>%
mutate(IV_fdi_outflow_pc = (IV_fdi_outflow-IV_fdi_outflow_lag1)/IV_fdi_outflow_lag1*100) %>%
mutate(IV_fdi_outflow_pc_lag1 = dplyr::lag(IV_fdi_outflow_pc,k=1)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_wgini_lag1 = dplyr::lag(IV_wgini,k=1)) %>%
mutate(IV_wgini_pc = (IV_wgini-IV_wgini_lag1)/IV_wgini_lag1*100) %>%
mutate(IV_wgini_pc_lag1 = dplyr::lag(IV_wgini_pc,k=1)) %>%
mutate(IV_wgini_pc_lag2 = dplyr::lag(IV_wgini_pc,k=2)) %>%
ungroup()
turn_na <- function(a){
a[abs(a)>10^10] <- NA
a
}
for(i in 2:length(df)){
df[,i] <- lapply(df[,i], turn_na)
}
for(i in 3:length(df)){
result <- paste0(colnames(df[,i]), " has ", sum(is.na(df[,i])), " NAs.")
print(result)
}
"adf" <- function(x,k = 0, int = TRUE, trend = FALSE){
# NB:  returns conventional lm summary so p-values for adf test are wrong!
require(dynlm)
dx <- diff(x)
formula <- paste("dx ~ L(x)")
if(k > 0)
formula <- paste(formula," + L(dx,1:k)")
if(trend){
s <- time(x)
t <- ts(s - s[1],start = s[1],freq = frequency(x))
formula <- paste(formula," + t")
}
if(!int) formula <- paste(formula," - 1")
summary(dynlm(as.formula(formula)))
}
adf_test <- function(df, x, k = k){
result <- data.frame(country = c(),
lx_t = c(),
lx_p = c(),
stationarity = c())
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
iv$Country <- as.character(iv$Country)
country <- data.frame(table(iv$Country))[,1]
for(i in 1:length(country)){
countryname = as.character(country[i])
temp <- iv %>%
filter(Country == countryname)
adf_iv <- ts(temp[,3])
adf(adf_iv, k = k, int = T, trend = T) -> adf_model
adf_model$coefficient[2,3] -> lx_t
adf_model$coefficient[2,4] -> lx_p
stationarity = c()
stationarity[lx_p < 0.05] <- "stationarity"
stationarity[lx_p > 0.05] <- "non-stationarity"
newrow <- c(countryname, lx_t, lx_p, stationarity)
result <- rbind(result, newrow)
}
colnames(result) <- c("country","lx_t","lx_p","stationarity")
print(result)
}
VA_adf <- adf_test(df,"DV_VA",1)
variety <- merge(VA_adf, nfc_adf, by = "country", all.y = T)
p_load(fBasics,fUnitRoots)
if (!require("punitroots"))install.packages("punitroots", repos="http://R-Forge.R-project.org")
if (!require("CADFtest"))install.packages("CADFtest")
#install.packages("ua")
library(punitroots)
padf <- function(df, x){
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
result = pCADFtest(Y=iv, max.lag.y = 5, criterion = "AIC", crosscorr=0.10)
print(result)
}
VA_padf <- padf(df,"DV_VA_pc")
nfc_padf <- padf(df,"DV_nfc_ls_pc")
hh_padf <- padf(df,"DV_hh_ls_pc")
lending_padf <- padf(df, "IV_lending_pc")
govexp_padf <- padf(df, "IV_gov_exp_pc")
gini_padf <- padf(df, "IV_gini_pc")
wgini_padf <- padf(df, "IV_wgini_pc")
trade_balance_padf <- padf(df, "IV_trade_balance_pc")
fdi_outflow_padf <- padf(df, "IV_fdi_outflow_pc")
#VA_country <- na.omit(variety$country[variety$va == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_VA_pc, DV_VA_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1, C_REER, C_wgdp, C_cpi,
C_m2_pc, C_REER_pc, C_wgdp_pc) -> va
#VA_country <- na.omit(variety$country[variety$va == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_VA_pc, DV_VA_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1, C_REER, C_wgdp, C_cpi,
C_M2_pc, C_REER_pc, C_wgdp_pc) -> va
#VA_country <- na.omit(variety$country[variety$va == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_VA_pc, DV_VA_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1, C_REER, C_wgdp, C_cpi,
C_M2, C_REER_pc, C_wgdp_pc) -> va
#VA_country <- na.omit(variety$country[variety$va == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_VA_pc, DV_VA_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1, C_REER, C_wgdp, C_cpi,
C_M2, C_REER, C_wgdp_pc) -> va
#VA_country <- na.omit(variety$country[variety$va == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_VA_pc, DV_VA_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1, C_REER, C_wgdp, C_cpi,
C_M2, C_REER, C_wgdp) -> va
#va[va$Country %in% VA_country,] -> va
va[is.na(va)] <- 0
aggregate(. ~ Country + Year, data = va, sum) -> va
va[va==0] <- NA
va <- va[!is.na(va$DV_VA_pc),]
library(tseries)
po.test(as.matrix(cbind(va$DV_VA_pc, va$IV_lending_pc), demean=FALSE))
#po.test(as.matrix(cbind(va$DV_VA_pc, va$IV_gov_exp_pc), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VA_pc, va$IV_trade_balance_pc), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VA_pc, va$IV_fdi_outflow_pc), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VA_pc, va$IV_wgini_pc), demean=FALSE))
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = va, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                      IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = va, model = 'random')
phtest(m1, m1_re)
View(trade_balance_padf)
View(va)
va <- va[order(va$Country, va$Year),]
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VAplus ~  DV_VAplus_lag1 +
IV_lendingplus + IV_lendingplus_lag1 + #IV_lendingplus_lag2 +
#                       IV_gov_expplus + IV_gov_expplus_lag1 + #IV_gov_expplus_lag2 +
IV_giniplus + IV_giniplus_lag1 + #IV_giniplus_lag2 +
IV_trade_balanceplus + IV_trade_balanceplus_lag1 + #IV_trade_balanceplus_lag2 +
IV_fdi_outflowplus + IV_fdi_outflowplus_lag1 + #IV_fdi_outflowplus_lag2 +
C_m2plus + C_REERplus, # + C_gdpplus,
data = va, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
#nfc_country <- na.omit(variety$country[variety$nfc == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_nfc_ls_pc, DV_nfc_ls_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1, C_m2_pc, C_REER_pc, C_wgdp_pc, C_REER, C_wgdp, C_cpi) -> nfc
#nfc_country <- na.omit(variety$country[variety$nfc == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_nfc_ls_pc, DV_nfc_ls_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1, C_M2, C_REER, C_wgdp, C_cpi) -> nfc
#nfc <- nfc[nfc$Country %in% nfc_country,]
nfc[is.na(nfc)] <- 0
aggregate(. ~ Country + Year, data = nfc, sum) -> nfc
nfc[nfc ==0] <- NA
nfc <- nfc[!is.na(nfc$DV_nfc_ls_pc),]
#nfc_country
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m2  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#  IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = nfc, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m2)
# PCSE
summary(m2, vcovBK)
# Durbin-Watson Statistics
pdwtest(m2)
# m1_re is a RE model
m2_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
# IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
# C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = nfc, model = 'random')
phtest(m2, m2_re)
#hh_country <- na.omit(variety$country[variety$hh == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_hh_ls_pc, DV_hh_ls_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1,
C_REER, C_wgdp, C_cpi) -> hh
#hh <- hh[hh$Country %in% hh_country,]
hh[is.na(hh)] <- 0
aggregate(. ~ Country + Year, data = hh, sum) -> hh
hh[hh ==0] <- NA
hh <- hh[!is.na(hh$DV_hh_ls_pc),]
#hh_country
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m3  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#  IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = hh, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m3)
# PCSE
summary(m3, vcovBK)
# Durbin-Watson Statistics
pdwtest(m3)
# m1_re is a RE model
m3_re  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
# IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = hh, model = 'random')
phtest(m3, m3_re)
View(nfc)
nfc <- nfc[order(nfc$Country, nfc$Year),]
df <- read.csv("../data_processing/financialization_df.csv")
df$X <- NULL
df <- df %>%
filter(Year >= 1960)
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("../data_processing/financialization_df.csv")
df$X <- NULL
df <- df %>%
filter(Year >= 1960)
colnames(df)
df <- df %>%
group_by(Country) %>%
mutate(IV_gini_lag1 = dplyr::lag(IV_gini,k=1)) %>%
mutate(IV_gini_pc = (IV_gini-IV_gini_lag1)/IV_gini_lag1*100) %>%
mutate(IV_gini_pc_lag1 = dplyr::lag(IV_gini_pc,k=1)) %>%
mutate(IV_gini_pc_lag2 = dplyr::lag(IV_gini_pc,k=2)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_outflow_lag1 = dplyr::lag(IV_fdi_outflow,k=1)) %>%
mutate(IV_fdi_outflow_pc = (IV_fdi_outflow-IV_fdi_outflow_lag1)/IV_fdi_outflow_lag1*100) %>%
mutate(IV_fdi_outflow_pc_lag1 = dplyr::lag(IV_fdi_outflow_pc,k=1)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_outflow_lag1 = dplyr::lag(IV_fdi_outflow,k=1)) %>%
mutate(IV_fdi_outflow_pc = (IV_fdi_outflow-IV_fdi_outflow_lag1)/IV_fdi_outflow_lag1*100) %>%
mutate(IV_fdi_outflow_pc_lag1 = dplyr::lag(IV_fdi_outflow_pc,k=1)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_wgini_lag1 = dplyr::lag(IV_wgini,k=1)) %>%
mutate(IV_wgini_pc = (IV_wgini-IV_wgini_lag1)/IV_wgini_lag1*100) %>%
mutate(IV_wgini_pc_lag1 = dplyr::lag(IV_wgini_pc,k=1)) %>%
mutate(IV_wgini_pc_lag2 = dplyr::lag(IV_wgini_pc,k=2)) %>%
ungroup()
turn_na <- function(a){
a[abs(a)>10^10] <- NA
a
}
for(i in 2:length(df)){
df[,i] <- lapply(df[,i], turn_na)
}
padf <- function(df, x){
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
result = pCADFtest(Y=iv, max.lag.y = 5, criterion = "AIC", crosscorr=0.10)
print(result)
}
VA_padf <- padf(df,"DV_VA_pc")
padf <- function(df, x){
df %>%
select(Country, Year, x) -> iv
iv <- na.omit(iv)
result = pCADFtest(Y=iv, max.lag.y = 5, criterion = "AIC", crosscorr=0.10)
print(result)
}
VA_padf <- padf(df,"DV_VA_pc")
#VA_country <- na.omit(variety$country[variety$va == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_VA_pc, DV_VA_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1, C_REER, C_wgdp, C_cpi,
C_M2, C_REER, C_wgdp) -> va
#va[va$Country %in% VA_country,] -> va
va[is.na(va)] <- 0
aggregate(. ~ Country + Year, data = va, sum) -> va
va[va==0] <- NA
va <- va[!is.na(va$DV_VA_pc),]
library(tseries)
po.test(as.matrix(cbind(va$DV_VA_pc, va$IV_lending_pc), demean=FALSE))
#po.test(as.matrix(cbind(va$DV_VA_pc, va$IV_gov_exp_pc), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VA_pc, va$IV_trade_balance_pc), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VA_pc, va$IV_fdi_outflow_pc), demean=FALSE))
po.test(as.matrix(cbind(va$DV_VA_pc, va$IV_wgini_pc), demean=FALSE))
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m1  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = va, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m1)
# PCSE
summary(m1, vcovBK)
# Durbin-Watson Statistics
pdwtest(m1)
# m1_re is a RE model
m1_re  <- plm(DV_VA_pc ~  DV_VA_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                      IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = va, model = 'random')
phtest(m1, m1_re)
#nfc_country <- na.omit(variety$country[variety$nfc == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_nfc_ls_pc, DV_nfc_ls_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1, C_M2, C_REER, C_wgdp, C_cpi) -> nfc
#nfc <- nfc[nfc$Country %in% nfc_country,]
nfc[is.na(nfc)] <- 0
aggregate(. ~ Country + Year, data = nfc, sum) -> nfc
nfc[nfc ==0] <- NA
nfc <- nfc[!is.na(nfc$DV_nfc_ls_pc),]
#nfc_country
library(tseries)
po.test(as.matrix(cbind(nfc$DV_nfc_ls_pc, nfc$IV_lending_pc), demean=FALSE))
#po.test(as.matrix(cbind(nfc$DV_nfc_ls_pc, nfc$IV_gov_exp_pc), demean=FALSE))
po.test(as.matrix(cbind(nfc$DV_nfc_ls_pc, nfc$IV_trade_balance_pc), demean=FALSE))
po.test(as.matrix(cbind(nfc$DV_nfc_ls_pc, nfc$IV_fdi_outflow_pc), demean=FALSE))
po.test(as.matrix(cbind(nfc$DV_nfc_ls_pc, nfc$IV_wgini_pc), demean=FALSE))
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m2  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#  IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = nfc, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m2)
# PCSE
summary(m2, vcovBK)
# Durbin-Watson Statistics
pdwtest(m2)
# m1_re is a RE model
m2_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
# IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
# C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = nfc, model = 'random')
phtest(m2, m2_re)
#hh_country <- na.omit(variety$country[variety$hh == "non-stationarity"])
df %>%
dplyr::select(Country, Year, DV_hh_ls_pc, DV_hh_ls_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1,
C_REER, C_wgdp, C_cpi) -> hh
#hh <- hh[hh$Country %in% hh_country,]
hh[is.na(hh)] <- 0
aggregate(. ~ Country + Year, data = hh, sum) -> hh
hh[hh ==0] <- NA
hh <- hh[!is.na(hh$DV_hh_ls_pc),]
#hh_country
library(Matrix)
library(plm)
library(car)
library(lmtest)
# m1 is an FE model
m3  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#  IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = hh, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(m3)
# PCSE
summary(m3, vcovBK)
# Durbin-Watson Statistics
pdwtest(m3)
# m1_re is a RE model
m3_re  <- plm(DV_hh_ls_pc ~  DV_hh_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
# IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = hh, model = 'random')
phtest(m3, m3_re)
