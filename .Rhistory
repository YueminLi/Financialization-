nfc_g <-  ggplot(data=nfc, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_nfc_ls)) +
scale_fill_gradient2(midpoint=200,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
nfc_g
ggplotly(nfc_g)
exp_country <- c("Canada", "Finland", "Germany", "France", "Hungary", "Iceland", "Italy", "Japan", "Korea", "Norway", "Sweden", "United Kingdom", "United States")
temp <- df[df$Country %in% ep_country, ]
temp <- df[df$Country %in% exp_country, ]
View(temp)
table(df$Country)
table(temp$Country)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# expm1 is an FE model
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(expm1)
# PCSE
summary(expm1, vcovBK)
# Durbin-Watson Statistics
pdwtest(expm1)
# expm1_re is a RE model
expm1_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                      IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = temp, model = 'random')
library(ggplot2)
library(plotly)
nfc <- select(df,
Year, Country, DV_nfc_ls)
library(ggplot2)
library(plotly)
nfc <- df %>%
select(Year, Country, DV_nfc_ls)
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("../data_processing/financialization_df.csv")
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("./data_processing/financialization_df.csv")
library(ggplot2)
library(plotly)
nfc <- df %>%
select(Year, Country, DV_nfc_ls)
nfc <- na.omit(nfc)
nfc_g <-  ggplot(data=nfc, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_nfc_ls)) +
scale_fill_gradient2(midpoint=200,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
nfc_g
ggplotly(nfc_g)
exp_country <- c("Canada", "Finland", "Germany", "France", "Hungary", "Iceland", "Italy", "Japan", "Korea", "Norway", "Sweden", "United Kingdom", "United States")
temp <- df[df$Country %in% exp_country, ]
library(Matrix)
library(plm)
library(car)
library(lmtest)
# expm1 is an FE model
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
View(df)
colnames(nfc)
colnames(temp)
df <- df %>%
group_by(Country) %>%
mutate(IV_gini_lag1 = dplyr::lag(IV_gini,k=1)) %>%
mutate(IV_gini_pc = (IV_gini-IV_gini_lag1)/IV_gini_lag1*100) %>%
mutate(IV_gini_pc_lag1 = dplyr::lag(IV_gini_pc,k=1)) %>%
mutate(IV_gini_pc_lag2 = dplyr::lag(IV_gini_pc,k=2)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_outflow_lag1 = dplyr::lag(IV_fdi_outflow,k=1)) %>%
mutate(IV_fdi_outflow_pc = (IV_fdi_outflow-IV_fdi_outflow_lag1)/IV_fdi_outflow_lag1*100) %>%
mutate(IV_fdi_outflow_pc_lag1 = dplyr::lag(IV_fdi_outflow_pc,k=1)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_wgini_lag1 = dplyr::lag(IV_wgini,k=1)) %>%
mutate(IV_wgini_pc = (IV_wgini-IV_wgini_lag1)/IV_wgini_lag1*100) %>%
mutate(IV_wgini_pc_lag1 = dplyr::lag(IV_wgini_pc,k=1)) %>%
mutate(IV_wgini_pc_lag2 = dplyr::lag(IV_wgini_pc,k=2)) %>%
ungroup()
library(ggplot2)
library(plotly)
nfc <- df %>%
select(Year, Country, DV_nfc_ls)
nfc <- na.omit(nfc)
nfc_g <-  ggplot(data=nfc, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_nfc_ls)) +
scale_fill_gradient2(midpoint=200,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
nfc_g
ggplotly(nfc_g)
exp_country <- c("Canada", "Finland", "Germany", "France", "Hungary", "Iceland", "Italy", "Japan", "Korea", "Norway", "Sweden", "United Kingdom", "United States")
temp <- df[df$Country %in% exp_country, ]
library(Matrix)
library(plm)
library(car)
library(lmtest)
# expm1 is an FE model
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(expm1)
# PCSE
summary(expm1, vcovBK)
# Durbin-Watson Statistics
pdwtest(expm1)
# expm1_re is a RE model
expm1_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                      IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = temp, model = 'random')
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
expm1_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'within',
effect = 'random', index = c('Country', 'Year'))
expm1_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                      IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = temp, model = 'random')
plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
+                      IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
+                      #                      IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
+                      IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
+                      IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
+                      IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
+                      #C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
+                      C_REER + C_wgdp + C_cpi,
+                  data = temp, model = 'random')
plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
+                      IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
+                      #                      IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
+                      IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
+                      IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
+                      IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
+                      #C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
+                      C_REER + C_wgdp + C_cpi,
+                  data = temp, model = 'random')
plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
+                      IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
+                      #                      IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
+                      IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
+                      IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
+                      IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
+                      #C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
+                      C_REER + C_wgdp + C_cpi,
+                  data = temp, model = 'random')
expm1_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                      IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = temp, model = 'random')
phtest(expm1, expm1_re)
View(temp)
#nfc_country <- na.omit(variety$country[variety$nfc == "non-stationarity"])
temp %>%
dplyr::select(Country, Year, DV_nfc_ls_pc, DV_nfc_ls_pc_lag1,
IV_lending_pc, IV_gov_exp_pc, IV_trade_balance_pc, IV_fdi_outflow_pc, IV_wgini_pc,
IV_lending_pc_lag1, IV_gov_exp_pc_lag1,
IV_trade_balance_pc_lag1, IV_fdi_outflow_pc_lag1,
IV_wgini_pc_lag1, C_M2, C_REER, C_wgdp, C_cpi) -> nfc
#nfc <- nfc[nfc$Country %in% nfc_country,]
nfc[is.na(nfc)] <- 0
aggregate(. ~ Country + Year, data = nfc, sum) -> nfc
nfc[nfc ==0] <- NA
nfc <- nfc[!is.na(nfc$DV_nfc_ls_pc),]
#nfc_country
library(Matrix)
library(plm)
library(car)
library(lmtest)
# expm1 is an FE model
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = nfc, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
library(Matrix)
library(plm)
library(car)
library(lmtest)
# expm1 is an FE model
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = nfc, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(expm1)
# PCSE
summary(expm1, vcovBK)
# Durbin-Watson Statistics
pdwtest(expm1)
# expm1_re is a RE model
expm1_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                      IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc +  IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc +IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc + C_REER_pc + C_gdp_pc + C_cpi_pc,
C_REER + C_wgdp + C_cpi,
data = nfc, model = 'random')
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("./data_processing/financialization_df.csv")
library(ggplot2)
library(plotly)
nfc <- df %>%
select(Year, Country, DV_nfc_ls)
nfc <- na.omit(nfc)
nfc_g <-  ggplot(data=nfc, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_nfc_ls)) +
scale_fill_gradient2(midpoint=200,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
nfc_g
ggplotly(nfc_g)
exp_country <- c("Canada", "Finland", "Germany", "France", "Hungary", "Iceland", "Italy", "Japan", "Korea", "Norway", "Sweden", "United Kingdom", "United States")
temp <- df[df$Country %in% exp_country, ]
library(Matrix)
library(plm)
library(car)
library(lmtest)
# expm1 is an FE model
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + #IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + #IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + #IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + #IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = nfc, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
View(temp)
library(Matrix)
library(plm)
library(car)
library(lmtest)
# expm1 is an FE model
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + #IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + #IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + #IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + #IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
library(Matrix)
library(plm)
library(car)
library(lmtest)
# expm1 is an FE model
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + #IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini + #IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + #IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + #IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
df <- df %>%
group_by(Country) %>%
mutate(IV_gini_lag1 = dplyr::lag(IV_gini,k=1)) %>%
mutate(IV_gini_pc = (IV_gini-IV_gini_lag1)/IV_gini_lag1*100) %>%
mutate(IV_gini_pc_lag1 = dplyr::lag(IV_gini_pc,k=1)) %>%
mutate(IV_gini_pc_lag2 = dplyr::lag(IV_gini_pc,k=2)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_outflow_lag1 = dplyr::lag(IV_fdi_outflow,k=1)) %>%
mutate(IV_fdi_outflow_pc = (IV_fdi_outflow-IV_fdi_outflow_lag1)/IV_fdi_outflow_lag1*100) %>%
mutate(IV_fdi_outflow_pc_lag1 = dplyr::lag(IV_fdi_outflow_pc,k=1)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_wgini_lag1 = dplyr::lag(IV_wgini,k=1)) %>%
mutate(IV_wgini_pc = (IV_wgini-IV_wgini_lag1)/IV_wgini_lag1*100) %>%
mutate(IV_wgini_pc_lag1 = dplyr::lag(IV_wgini_pc,k=1)) %>%
mutate(IV_wgini_pc_lag2 = dplyr::lag(IV_wgini_pc,k=2)) %>%
ungroup()
turn_na <- function(a){
a[abs(a)>10^10] <- NA
a
}
for(i in 2:length(df)){
df[,i] <- lapply(df[,i], turn_na)
}
library(ggplot2)
library(plotly)
nfc <- df %>%
select(Year, Country, DV_nfc_ls)
nfc <- na.omit(nfc)
nfc_g <-  ggplot(data=nfc, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_nfc_ls)) +
scale_fill_gradient2(midpoint=200,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
nfc_g
ggplotly(nfc_g)
exp_country <- c("Canada", "Finland", "Germany", "France", "Hungary", "Iceland", "Italy", "Japan", "Korea", "Norway", "Sweden", "United Kingdom", "United States")
temp <- df[df$Country %in% exp_country, ]
library(Matrix)
library(plm)
library(car)
library(lmtest)
# expm1 is an FE model
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + #IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini + #IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + #IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + #IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(expm1)
# PCSE
summary(expm1, vcovBK)
# Durbin-Watson Statistics
pdwtest(expm1)
# expm1_re is a RE model
expm1_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + #IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini + #IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + #IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + #IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'random')
library(Matrix)
library(plm)
library(car)
library(lmtest)
# expm1 is an FE model
expm1  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + #IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + #IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + #IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + #IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'within',
effect = 'twoways', index = c('Country', 'Year'))
summary(expm1)
# PCSE
summary(expm1, vcovBK)
# Durbin-Watson Statistics
pdwtest(expm1)
# expm1_re is a RE model
expm1_re  <- plm(DV_nfc_ls_pc ~  DV_nfc_ls_pc_lag1 +
IV_lending_pc + #IV_lending_pc_lag1 + #IV_lending_pc_lag2 +
#                       IV_gov_exp_pc + IV_gov_exp_pc_lag1 + #IV_gov_exp_pc_lag2 +
IV_wgini_pc + #IV_wgini_pc_lag1 + #IV_gini_pc_lag2 +
IV_trade_balance_pc + #IV_trade_balance_pc_lag1 + #IV_trade_balance_pc_lag2 +
IV_fdi_outflow_pc + #IV_fdi_outflow_pc_lag1 + #IV_fdi_outflow_pc_lag2 +
#C_m2_pc +
C_REER + C_wgdp + C_cpi,
data = temp, model = 'random')
View(temp)
View(temp)
View(temp)
ggplot(aes(x=IV_trade_balance_pc, y = DV_nfc_ls_pc), data = temp) +
geom_point(color = Country)
View(temp)
ggplot(aes(x=IV_trade_balance_pc, y = DV_nfc_ls_pc), data = temp) +
geom_point(color = "Country")
ggplot(aes(x=IV_trade_balance_pc, y = DV_nfc_ls_pc), data = temp) +
geom_point(fill = "Country")
ggplot(aes(x=IV_trade_balance_pc, y = DV_nfc_ls_pc,fill = "Country"), data = temp) +
geom_point()
ggplot(aes(x=IV_trade_balance_pc, y = DV_nfc_ls_pc,color = "Country"), data = temp) +
geom_point()
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("./data_processing/financialization_df.csv")
```{r}
if (!require("pacman")) install.packages("pacman")
p_load(data.table, tidyverse, Hmisc, Matrix, lfe, plm, dynlm, car, lmtest, tseries, broom, knitr)
df <- read.csv("./data_processing/financialization_df.csv")
df <- df %>%
group_by(Country) %>%
mutate(IV_gini_lag1 = dplyr::lag(IV_gini,k=1)) %>%
mutate(IV_gini_pc = (IV_gini-IV_gini_lag1)/IV_gini_lag1*100) %>%
mutate(IV_gini_pc_lag1 = dplyr::lag(IV_gini_pc,k=1)) %>%
mutate(IV_gini_pc_lag2 = dplyr::lag(IV_gini_pc,k=2)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_fdi_outflow_lag1 = dplyr::lag(IV_fdi_outflow,k=1)) %>%
mutate(IV_fdi_outflow_pc = (IV_fdi_outflow-IV_fdi_outflow_lag1)/IV_fdi_outflow_lag1*100) %>%
mutate(IV_fdi_outflow_pc_lag1 = dplyr::lag(IV_fdi_outflow_pc,k=1)) %>%
ungroup()
df <- df %>%
group_by(Country) %>%
mutate(IV_wgini_lag1 = dplyr::lag(IV_wgini,k=1)) %>%
mutate(IV_wgini_pc = (IV_wgini-IV_wgini_lag1)/IV_wgini_lag1*100) %>%
mutate(IV_wgini_pc_lag1 = dplyr::lag(IV_wgini_pc,k=1)) %>%
mutate(IV_wgini_pc_lag2 = dplyr::lag(IV_wgini_pc,k=2)) %>%
ungroup()
library(ggplot2)
library(plotly)
nfc <- df %>%
select(Year, Country, DV_nfc_ls)
nfc <- na.omit(nfc)
nfc_g <-  ggplot(data=nfc, aes(y=Year, x = Country)) +
geom_tile(aes(fill = DV_nfc_ls)) +
scale_fill_gradient2(midpoint=200,
low="#FFFFFF", mid="#ffb7c5", high = "#FF5576") +
theme_bw()
nfc_g
ggplotly(nfc_g)
exp_country <- c("Canada", "Finland", "Germany", "France", "Hungary", "Iceland", "Italy", "Japan", "Korea", "Norway", "Sweden", "United Kingdom", "United States")
temp <- df[df$Country %in% exp_country, ]
ggplot(aes(x=IV_trade_balance_pc, y = DV_nfc_ls_pc), data = temp) +
geom_point(aes(color = "Country"))
class(temp$Country)
temp$Country <- factor(temp$Country)
ggplot(aes(x=IV_trade_balance_pc, y = DV_nfc_ls_pc), data = temp) +
geom_point(aes(color = "Country"))
temp$Country <- factor(temp$Country)
ggplot(aes(x=IV_trade_balance_pc, y = DV_nfc_ls_pc), data = temp) +
geom_point(aes(fill = "Country"))
temp$Country <- factor(temp$Country)
ggplot(aes(x=IV_trade_balance_pc, y = DV_nfc_ls_pc), stat = "identity", data = temp) +
geom_point(aes(fill = "Country"))
temp$Country <- factor(temp$Country)
ggplot(aes(x=IV_trade_balance_pc, y = DV_nfc_ls_pc), stat = "identity", data = temp) +
geom_point(aes(color = "Country"))
